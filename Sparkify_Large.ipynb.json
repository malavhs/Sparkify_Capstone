{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Sparkify Project Workspace\n",
    "This workspace contains a tiny subset (128MB) of the full dataset available (12GB). Feel free to use this workspace to build your project, or to explore a smaller subset with Spark before deploying your cluster on the cloud. Instructions for setting up your Spark cluster is included in the last lesson of the Extracurricular Spark Course content.\n",
    "\n",
    "You can follow the steps below to guide your data analysis and model building portion of this project."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# import libraries\n",
    "from pyspark.sql import SparkSession\n",
    "from pyspark.sql.functions import udf, isnan, when, count, col,trim\n",
    "from pyspark.sql.types import StringType\n",
    "from pyspark.sql.types import IntegerType\n",
    "from pyspark.sql.functions import desc\n",
    "from pyspark.sql.functions import asc\n",
    "from pyspark.sql.functions import sum as Fsum\n",
    "from tabulate import tabulate\n",
    "import datetime\n",
    "import pyspark\n",
    "import seaborn as sns\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "from pyspark.sql import functions as f\n",
    "from pyspark.sql.functions import from_unixtime, countDistinct, avg, max, min, date_format, unix_timestamp, dayofweek\n",
    "from pyspark.sql import Window\n",
    "from pyspark.sql import types\n",
    "from pyspark.ml import Pipeline, PipelineModel\n",
    "from pyspark.ml.feature import Imputer, StringIndexer, StringIndexerModel, OneHotEncoder, VectorAssembler, MinMaxScaler\n",
    "from pyspark.ml.feature import StandardScaler, OneHotEncoderModel\n",
    "from pyspark.ml.feature import StringIndexer\n",
    "import threading\n",
    "from pyspark.ml.classification import GBTClassifier, RandomForestClassifier\n",
    "from pyspark.ml.tuning import ParamGridBuilder, CrossValidator\n",
    "from pyspark.ml.evaluation import BinaryClassificationEvaluator\n",
    "from pyspark.mllib.evaluation import MulticlassMetrics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# create a Spark session\n",
    "spark = SparkSession \\\n",
    "    .builder \\\n",
    "    .appName(\"Sparkify\") \\\n",
    "    .getOrCreate()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Row(artist='Martin Orford', auth='Logged In', firstName='Joseph', gender='M', itemInSession=20, lastName='Morales', length=597.55057, level='free', location='Corpus Christi, TX', method='PUT', page='NextSong', registration=1532063507000, sessionId=292, song='Grand Designs', status=200, ts=1538352011000, userAgent='\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36\"', userId='293'),\n",
       " Row(artist=\"John Brown's Body\", auth='Logged In', firstName='Sawyer', gender='M', itemInSession=74, lastName='Larson', length=380.21179, level='free', location='Houston-The Woodlands-Sugar Land, TX', method='PUT', page='NextSong', registration=1538069638000, sessionId=97, song='Bulls', status=200, ts=1538352025000, userAgent='\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36\"', userId='98'),\n",
       " Row(artist='Afroman', auth='Logged In', firstName='Maverick', gender='M', itemInSession=184, lastName='Santiago', length=202.37016, level='paid', location='Orlando-Kissimmee-Sanford, FL', method='PUT', page='NextSong', registration=1535953455000, sessionId=178, song='Because I Got High', status=200, ts=1538352118000, userAgent='\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36\"', userId='179'),\n",
       " Row(artist=None, auth='Logged In', firstName='Maverick', gender='M', itemInSession=185, lastName='Santiago', length=None, level='paid', location='Orlando-Kissimmee-Sanford, FL', method='PUT', page='Logout', registration=1535953455000, sessionId=178, song=None, status=307, ts=1538352119000, userAgent='\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36\"', userId='179'),\n",
       " Row(artist='Lily Allen', auth='Logged In', firstName='Gianna', gender='F', itemInSession=22, lastName='Campos', length=194.53342, level='paid', location='Mobile, AL', method='PUT', page='NextSong', registration=1535931018000, sessionId=245, song='Smile (Radio Edit)', status=200, ts=1538352124000, userAgent='Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Firefox/31.0', userId='246')]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "import ibmos2spark\n",
    "# @hidden_cell\n",
    "credentials = {\n",
    "    'endpoint': 'https://s3-api.us-geo.objectstorage.service.networklayer.com',\n",
    "    'service_id': 'iam-ServiceId-4b5c4f5f-1526-415f-a000-8c078168d42e',\n",
    "    'iam_service_endpoint': 'https://iam.cloud.ibm.com/oidc/token',\n",
    "    'api_key': 'CIbP7Y5L52DAfe_Abrzr2pqXxd5TvXM8yNkr9OYcX8UM'\n",
    "}\n",
    "\n",
    "configuration_name = 'os_62cafdb4eb294897a148f87b5e2078be_configs'\n",
    "cos = ibmos2spark.CloudObjectStorage(sc, credentials, configuration_name, 'bluemix_cos')\n",
    "\n",
    "from pyspark.sql import SparkSession\n",
    "spark = SparkSession.builder.getOrCreate()\n",
    "# Since JSON data can be semi-structured and contain additional metadata, it is possible that you might face issues with the DataFrame layout.\n",
    "# Please read the documentation of 'SparkSession.read()' to learn more about the possibilities to adjust the data loading.\n",
    "# PySpark documentation: http://spark.apache.org/docs/2.0.2/api/python/pyspark.sql.html#pyspark.sql.DataFrameReader.json\n",
    "\n",
    "df = spark.read.json(cos.url('medium-sparkify-event-data.json', 'sparkly-donotdelete-pr-sqlldrhf7nldiu'))\n",
    "df.take(5)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "root\n",
      " |-- artist: string (nullable = true)\n",
      " |-- auth: string (nullable = true)\n",
      " |-- firstName: string (nullable = true)\n",
      " |-- gender: string (nullable = true)\n",
      " |-- itemInSession: long (nullable = true)\n",
      " |-- lastName: string (nullable = true)\n",
      " |-- length: double (nullable = true)\n",
      " |-- level: string (nullable = true)\n",
      " |-- location: string (nullable = true)\n",
      " |-- method: string (nullable = true)\n",
      " |-- page: string (nullable = true)\n",
      " |-- registration: long (nullable = true)\n",
      " |-- sessionId: long (nullable = true)\n",
      " |-- song: string (nullable = true)\n",
      " |-- status: long (nullable = true)\n",
      " |-- ts: long (nullable = true)\n",
      " |-- userAgent: string (nullable = true)\n",
      " |-- userId: string (nullable = true)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Print Schema\n",
    "df.printSchema()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Row(artist='Martin Orford', auth='Logged In', firstName='Joseph', gender='M', itemInSession=20, lastName='Morales', length=597.55057, level='free', location='Corpus Christi, TX', method='PUT', page='NextSong', registration=1532063507000, sessionId=292, song='Grand Designs', status=200, ts=1538352011000, userAgent='\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36\"', userId='293')]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Print first record for EDA\n",
    "df.head(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Remove empty User IDs\n",
    "df = df.filter(df.userId != '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "def missing_perc(df, cols, nrows):\n",
    "    '''\n",
    "    INPUT:\n",
    "    df - (spark dataframe) df as defined at the top of the notebook \n",
    "    cols - (list) list of columns for which we want to check missing values\n",
    "    nrows - (int) count of number of rows in dataframe\n",
    "    \n",
    "    OUTPUT:\n",
    "    missing_df_perc - (pandas dataframe) Dataframe of number of missing values and percentages\n",
    "    '''\n",
    "    missing_df = df.select([count(when(isnan(c) | df[c].isNull() | (trim(df[c]) == ''), c)).alias(c) for c in cols])\n",
    "    missing_df_perc = spark.createDataFrame([(missing_df.columns[c], missing_df.collect()[0][c],\n",
    "                                                      round(float(missing_df.collect()[0][c]) / float(nrows) * 100, 6)) for\n",
    "                                                     c in range(len(cols))],\n",
    "                                                    [\"col_name\", \"missing_count\", \"missing_percen\"])\n",
    "    missing_df_perc = missing_df_perc.orderBy('missing_percen', ascending=False)\n",
    "    x = missing_df_perc.toPandas()\n",
    "    print(\"Missing count and percentages:\\n\" + tabulate(x, headers='keys', tablefmt='psql'))\n",
    "    return missing_df_perc"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define columns and count rows\n",
    "ids = ['firstName','lastName','song']\n",
    "cols = ['userId','auth','gender','itemInSession','length','level','location','method','page','registration','sessionId','status','ts','userAgent','userId']\n",
    "nrows = df.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Missing count and percentages:\n",
      "+----+---------------+-----------------+------------------+\n",
      "|    | col_name      |   missing_count |   missing_percen |\n",
      "|----+---------------+-----------------+------------------|\n",
      "|  0 | length        |           95128 |          18.0165 |\n",
      "|  1 | userId        |               0 |           0      |\n",
      "|  2 | auth          |               0 |           0      |\n",
      "|  3 | gender        |               0 |           0      |\n",
      "|  4 | itemInSession |               0 |           0      |\n",
      "|  5 | level         |               0 |           0      |\n",
      "|  6 | location      |               0 |           0      |\n",
      "|  7 | method        |               0 |           0      |\n",
      "|  8 | page          |               0 |           0      |\n",
      "|  9 | registration  |               0 |           0      |\n",
      "| 10 | sessionId     |               0 |           0      |\n",
      "| 11 | status        |               0 |           0      |\n",
      "| 12 | ts            |               0 |           0      |\n",
      "| 13 | userAgent     |               0 |           0      |\n",
      "| 14 | userId        |               0 |           0      |\n",
      "+----+---------------+-----------------+------------------+\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "DataFrame[col_name: string, missing_count: bigint, missing_percen: double]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "missing_perc(df,cols,nrows)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Exploratory Data Analysis\n",
    "When you're working with the full dataset, perform EDA by loading a small subset of the data and doing basic manipulations within Spark. In this workspace, you are already provided a small subset of data you can explore.\n",
    "\n",
    "### Define Churn\n",
    "\n",
    "Once you've done some preliminary analysis, create a column `Churn` to use as the label for your model. I suggest using the `Cancellation Confirmation` events to define your churn, which happen for both paid and free users. As a bonus task, you can also look into the `Downgrade` events.\n",
    "\n",
    "### Explore Data\n",
    "Once you've defined churn, perform some exploratory data analysis to observe the behavior for users who stayed vs users who churned. You can start by exploring aggregates on these two groups of users, observing how much of a specific action they experienced per a certain time unit or number of songs played."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Creating 'Churn' column\n",
    "df = df.withColumn('Churn', f.when(f.col('page') == 'Cancellation Confirmation', 1).otherwise(0))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Setting up the window\n",
    "range_begin = Window.unboundedPreceding\n",
    "range_end = Window.unboundedFollowing\n",
    "window_users = Window.partitionBy(\"userId\").rangeBetween(range_begin, range_end)\n",
    "df = df.withColumn(\"Churn\",f.sum(\"Churn\").over(window_users))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-----+-----+\n",
      "|Churn|count|\n",
      "+-----+-----+\n",
      "|    0|  349|\n",
      "|    1|   99|\n",
      "+-----+-----+\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Count users who churned (1) v/s those who didn't (0)\n",
    "df.select('userId','Churn').distinct().groupBy('Churn').count().show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Churn w.r.t gender\n",
    "no_gender = df.select('userId','gender','Churn').distinct().groupBy('gender','Churn').count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 402.375x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.catplot(x = 'gender', y = 'count',hue = 'Churn', data = no_gender.toPandas(), kind = 'bar');"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Churn w.r.t auth\n",
    "no_auth = df.select('userId','auth','Churn').distinct().groupBy('auth','Churn').count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 402.375x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.catplot(x = 'auth', y = 'count',hue = 'Churn', data = no_auth.toPandas(), kind = 'bar');"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Churn w.r.t level\n",
    "no_level = df.select('userId','level','Churn').distinct().groupBy('level','Churn').count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 402.375x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.catplot(x = 'level', y = 'count',hue = 'Churn', data = no_level.toPandas(), kind = 'bar');"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Split location column into city and state\n",
    "split_col = pyspark.sql.functions.split(df['location'], ',')\n",
    "df = df.withColumn('user_city',split_col.getItem(0))\n",
    "no_city = df.select('userId','user_city').distinct().groupBy('user_city').count().orderBy('count', ascending = False)\n",
    "df = df.withColumn('user_state',split_col.getItem(1))\n",
    "no_loc = df.select('userId','user_state').distinct().groupBy('user_state').count().orderBy('count', ascending = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0.5, 1.0, 'Top 10 States')"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.barplot(x = 'user_state', y = 'count', data = no_loc.toPandas().head(10));\n",
    "plt.xticks(rotation=90)\n",
    "plt.title('Top 10 States')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0.5, 1.0, 'Top 15 cities')"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.barplot(x = 'user_city', y = 'count', data = no_city.toPandas().head(15));\n",
    "plt.xticks(rotation=90)\n",
    "plt.title('Top 15 cities')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Churn w.r.t State\n",
    "state_churn = df.select('userId','user_state','Churn').distinct().groupBy('user_state','Churn').count().orderBy('user_state','count', ascending = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 402.375x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.catplot(y = 'user_state', x = 'count',hue = 'Churn', data = state_churn.toPandas().head(10), kind = 'bar', orient = \"h\");\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create new columns based on timestamp column\n",
    "df = df.withColumn(\"Hour_of_day\", from_unixtime(\"ts\", \"HH\"))\n",
    "df = df.withColumn('day_of_month',(from_unixtime(\"ts\", \"dd\")))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Drop columns that are unnecessary\n",
    "df = df.drop('firstName','lastName','method','status','registration','auth', 'location')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "root\n",
      " |-- artist: string (nullable = true)\n",
      " |-- gender: string (nullable = true)\n",
      " |-- itemInSession: long (nullable = true)\n",
      " |-- length: double (nullable = true)\n",
      " |-- level: string (nullable = true)\n",
      " |-- page: string (nullable = true)\n",
      " |-- sessionId: long (nullable = true)\n",
      " |-- song: string (nullable = true)\n",
      " |-- ts: long (nullable = true)\n",
      " |-- userAgent: string (nullable = true)\n",
      " |-- userId: string (nullable = true)\n",
      " |-- Churn: long (nullable = true)\n",
      " |-- user_city: string (nullable = true)\n",
      " |-- user_state: string (nullable = true)\n",
      " |-- Hour_of_day: string (nullable = true)\n",
      " |-- day_of_month: string (nullable = true)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Print updated schema\n",
    "df.printSchema()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Grouping Users by Session Id and Churn\n",
    "unique_sessions_by_id = ((df.groupBy('userId','Churn').agg(countDistinct('sessionId')).orderBy('userId')).toPandas())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([<matplotlib.axes._subplots.AxesSubplot object at 0x119b1a9d0>,\n",
       "       <matplotlib.axes._subplots.AxesSubplot object at 0x119cbbe80>],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "unique_sessions_by_id['count(sessionId)'].hist(by =  unique_sessions_by_id['Churn'], bins = 15 )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Grouping Users by Average Song Length and Churn\n",
    "avg_length_songs_by_id = ((df.groupBy('userId','Churn').agg(avg('length')).orderBy('userId')).toPandas())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([<matplotlib.axes._subplots.AxesSubplot object at 0x119a9e5b0>,\n",
       "       <matplotlib.axes._subplots.AxesSubplot object at 0x119a876d0>],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYIAAAEQCAYAAAC9VHPBAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAVQElEQVR4nO3df7DddZ3f8edrA2Vd0RUksGkIG+rGFtgdYzdDnWHaYlkl1d0G/0DjTjXbYSbOLljd2ukE6xTbkW7aEelOR+xGsaQ7Kk0rSqZSu0zGrdoRMLCRECKSSoSQmETXXWDr4BDf/eN8o9fLubm/zrnfb873+Zg5c8/5nB/3le85J6/7/Z2qQpLUXz/XdgBJUrssAknqOYtAknrOIpCknrMIJKnnLAJJ6jmLQJJ6ziI4TSQ5N8nnkvxVku8k+e22M0ltSHJDkt1Jnk9yR9t5JsEZbQfQnH0U+BFwAbAW+EKSb1TVvnZjSUvuMPAh4GrgJS1nmQhxz+LuS/JS4AfAr1bVt5qxPwaerqotrYaTWpLkQ8CFVfU7bWc53blo6PTwauDEyRJofAO4rKU8kiaIRXB6OBv4y2ljfwm8rIUskiaMRXB6eA54+bSxlwPPtpBF0oSxCE4P3wLOSLJmythrAFcUS1o0i+A0UFV/BdwF/JskL01yBbAB+ON2k0lLL8kZSX4eWAYsS/LzSdwCchEsgtPH7zHYVO4Y8Bngd910VD31AeCHwBbgHzfXP9BqotOcm49KUs85RyBJPWcRSFLPWQSS1HMWgST1nEUgST3XiW1vzzvvvFq9enXbMTSBHnzwwe9V1fK2c8yH3weNw6m+C50ogtWrV7N79+62Y2gCJflO2xnmy++DxuFU3wUXDUlSz1kEktRzFoEk9ZxFIEk9ZxFII9AcAfOBJN9Isi/Jv27Gz01yb5LHm5/ntJ1Vms4ikEbjeeAfVNVrgLXA+iSvY3CEzF1VtQbY1dyWOsUikEagBp5rbp7ZXIrBeSO2N+PbgWtaiCedkkUgjUiSZUn2MDhnxL1VdT9wQVUdAWh+nt9mRmmYTuxQpvFbveULsz7m4NY3L0GSyVVVJ4C1SV4BfC7Jr871uUk2A5sBLrroojEl7C4/n+2adY4gyaokX0qyv1kJ9p5m/INJnk6yp7m8acpzbkxyIMljSa4e5z9A6pqq+gvgT4H1wNEkKwCan8dmeM62qlpXVeuWLz+tjoihCTCXRUMvAO+rqkuA1wHXJ7m0ue/WqlrbXO4BaO7bCFzG4ItwW5JlY8gudUaS5c2cAEleAvwG8E1gJ7Cpedgm4O52Ekozm3XRULNc8+QyzmeT7AdWnuIpG4A7q+p54IkkB4DLga+NIK/UVSuA7c0fPT8H7Kiq/5Hka8COJNcBTwLXthlSGmZe6wiSrAZeC9wPXAHckOSdwG4Gcw0/YFAS90152iGGFEffl4lqslTVwwy+G9PHvw9ctfSJpLmb81ZDSc4GPgu8t6qeAT4GvIrBNtNHgFtOPnTI0+tFAy4TlaROmFMRJDmTQQl8qqruAqiqo1V1oqp+DHycweIfGMwBrJry9AuBw6OLLEkapblsNRTgdmB/VX1kyviKKQ97C/BIc30nsDHJWUkuBtYAD4wusiRplOayjuAK4B3A3mZnGYD3A29PspbBYp+DwLsAqmpfkh3Aowy2OLq+2b5aktRBc9lq6KsMX+5/zymeczNw8yJySZKWiIeYkKSeswgkqecsAknqOYtAknrOIpCknrMIJKnnLAJJ6jmLQJJ6ziKQpJ6zCCSp5ywCSeo5i0CSes4ikKSeswgkqecsAknqOYtAknrOIpCknrMIJKnnLAJJ6jmLQJJ6ziKQpJ6zCKQRSLIqyZeS7E+yL8l7mvEPJnk6yZ7m8qa2s0rTndF2AGlCvAC8r6oeSvIy4MEk9zb33VpVH24xm3RKFoE0AlV1BDjSXH82yX5gZbuppLlx0ZA0YklWA68F7m+GbkjycJJPJjlnhudsTrI7ye7jx48vUVJpwCKQRijJ2cBngfdW1TPAx4BXAWsZzDHcMux5VbWtqtZV1brly5cvWV4JLAJpZJKcyaAEPlVVdwFU1dGqOlFVPwY+DlzeZkZpGItAGoEkAW4H9lfVR6aMr5jysLcAjyx1Nmk2riyWRuMK4B3A3iR7mrH3A29PshYo4CDwrnbiSTOzCKQRqKqvAhly1z1LnUWaLxcNSVLPzVoEp9hj8twk9yZ5vPl5zpTn3JjkQJLHklw9zn+AJGlx5jJHcHKPyUuA1wHXJ7kU2ALsqqo1wK7mNs19G4HLgPXAbUmWjSO8JGnxZi2CqjpSVQ81158FTu4xuQHY3jxsO3BNc30DcGdVPV9VTwAHcJM5Seqsea0jmLbH5AXNbvUnd68/v3nYSuCpKU87xJBd7d2TUpK6Yc5FMGSPyRkfOmSsXjTgnpSS1AlzKoJhe0wCR0/uLNP8PNaMHwJWTXn6hcDh0cSVJI3aXLYaGrrHJLAT2NRc3wTcPWV8Y5KzklwMrAEeGF1kSdIozWWHspn2mNwK7EhyHfAkcC1AVe1LsgN4lMEWR9dX1YmRJ5ckjcSsRXCKPSYBrprhOTcDNy8ilyRpibhnsST1nEUgST1nEUhSz1kEktRzFoEk9ZxFIEk9ZxFIUs9ZBJLUcxaBJPWcRSBJPWcRSFLPWQSS1HMWgST1nEUgST1nEUhSz1kE0ggkWZXkS0n2J9mX5D3N+LlJ7k3yePPznLazStNZBNJovAC8r6ouAV4HXJ/kUmALsKuq1gC7mttSp1gE0ghU1ZGqeqi5/iywH1gJbAC2Nw/bDlzTTkJpZhaBNGJJVgOvBe4HLqiqIzAoC+D89pJJw1kE0gglORv4LPDeqnpmHs/bnGR3kt3Hjx8fX0BpCItAGpEkZzIogU9V1V3N8NEkK5r7VwDHhj23qrZV1bqqWrd8+fKlCSw1LAJpBJIEuB3YX1UfmXLXTmBTc30TcPdSZ5Nmc0bbAaQJcQXwDmBvkj3N2PuBrcCOJNcBTwLXtpRPmpFFII1AVX0VyAx3X7WUWaT5ctGQJPWcRSBJPWcRSFLPWQSS1HMWgST1nEUgST1nEUhSz81aBEk+meRYkkemjH0wydNJ9jSXN02578YkB5I8luTqcQWXJI3GXOYI7gDWDxm/tarWNpd7AJrjr28ELmuec1uSZaMKK0kavVmLoKq+DPz5HF9vA3BnVT1fVU8AB4DLF5FPkjRmi1lHcEOSh5tFRydPv7cSeGrKYw41Y5KkjlpoEXwMeBWwFjgC3NKMDzvWSg17AY+/LkndsKAiqKqjVXWiqn4MfJyfLv45BKya8tALgcMzvIbHX5ekDlhQEZw80UbjLcDJLYp2AhuTnJXkYmAN8MDiIkqSxmnWw1An+QxwJXBekkPATcCVSdYyWOxzEHgXQFXtS7IDeBR4Abi+qk6MJ7okaRRmLYKqevuQ4dtP8fibgZsXE0qSplu95QuzPubg1jcvQZLJ457FktRzFoEk9ZxFIEk9ZxFIUs9ZBJLUcxaBJPWcRSBJPWcRSFLPWQSS1HMWgTQC8z2Tn9QlFoE0GncwxzP5SV1jEUgjMM8z+UmdYhFI4zXsTH5Sp1gE0vjMdCa/F/GMfWqTRSCNySnO5DfssZ6xT62xCKQxOcWZ/KROmfXENJJmN58z+UldYxFIIzDfM/lJXeKiIUnqOYtAknrORUOSJoYnuF8Y5wgkqecsAknqOYtAknrOIpCknrMIJKnnLAJJ6jmLQJJ6ziKQpJ6zCCSp5ywCSeo5i0CSem7WImjOtXosySNTxs5Ncm+Sx5uf50y578YkB5I8luTqcQWXJI3GXOYI7gDWTxvbAuyqqjXAruY2SS4FNgKXNc+5LcmykaWVJI3crEVQVV8G/nza8AZge3N9O3DNlPE7q+r5qnoCOMApztMqSWrfQtcRXFBVRwCan+c34yuBp6Y87lAz9iJJNifZnWT38ePHFxhDkrRYo15ZnCFjNeyBVbWtqtZV1brly5ePOIYkaa4WWgRHk6wAaH4ea8YPAaumPO5C4PDC40mSxm2hRbAT2NRc3wTcPWV8Y5KzklwMrAEeWFxESdI4zXqqyiSfAa4EzktyCLgJ2ArsSHId8CRwLUBV7UuyA3gUeAG4vqpOjCm7JGkEZi2Cqnr7DHddNcPjbwZuXkwoSZNjLucRVrvcs1iSes4ikKSeswgkqecsAmkE5ntMLqlLLAJpNO5gjsfkkrrGIpBGYJ7H5JI6xSKQxmemY3K9iMfeUpssAqkDPPaW2mQRSOMz0zG5pE6xCKTxmemYXFKnWATSCDTH5Poa8DeTHGqOw7UVeEOSx4E3NLelzpn1WEOSZjffY3JJXeIcgST1nHMEE8CjO0paDOcIJKnnLAJJ6jmLQJJ6ziKQpJ6zCCSp5ywCSeo5i0CSes4ikKSeswgkqecsAknqOYtAknrOIpCknrMIJKnnLAJJ6jmLQJJ6ziKQpJ6zCCSp5xZ1hrIkB4FngRPAC1W1Lsm5wH8FVgMHgbdW1Q8WF1OSNC6jmCN4fVWtrap1ze0twK6qWgPsam5LkjpqHIuGNgDbm+vbgWvG8DskSSOy2JPXF/AnSQr4o6raBlxQVUcAqupIkvOHPTHJZmAzwEUXXbTIGJJGbfWWL8z6mINb37wESTRuiy2CK6rqcPOf/b1JvjnXJzalsQ1g3bp1tcgckqQFWtSioao63Pw8BnwOuBw4mmQFQPPz2GJDSpLGZ8FFkOSlSV528jrwRuARYCewqXnYJuDuxYaUTmdJDibZm2RPkt1t55GmW8yioQuAzyU5+TqfrqovJvk6sCPJdcCTwLWLjymd9l5fVd9rO4Q0zIKLoKq+DbxmyPj3gasWE0qStHQWu7JY0uyGbV33M9yKbunMZWso6NcWUR5iQhq/K6rqbwP/ELg+yd+b/oCq2lZV66pq3fLly5c+oXrNIpDGbIat66TOsAikMTrF1nVSZ7iOQBqvoVvXtRtJ+lkWgTRGM21dJ3WJi4YkqeecI5C0YHPdFFPd5hyBJPWcRSBJPWcRSFLPWQSS1HMWgST1nEUgST3n5qPShPFcw6PRp+noHIEk9ZxFIEk9ZxFIUs9ZBJLUcxaBJPWcRSBJPefmo9JpwiN9alycI5CknrMIJKnnLAJJ6jmLQJJ6ziKQpJ5zqyH9RJ8OsiXppywCqYfcFHXpLOW0Xugfai4akqSeswgkqefGVgRJ1id5LMmBJFvG9XukrvO7oK4byzqCJMuAjwJvAA4BX0+ys6oeHcfvm2RdW5brCuX58bug08G45gguBw5U1ber6kfAncCGMf0uqcv8LqjzxrXV0ErgqSm3DwF/ZyEv5F+gk2tUczsdf/9H9l2QxmVcRZAhY/UzD0g2A5ubm88leWzBv+zfDR0+D/jeQl9zDHqTZ4b3YzYLzjPL7/vlhbzmCM36XYBTfh+69LnpUhboQJ4pn73Ws8CseWb8LoyrCA4Bq6bcvhA4PPUBVbUN2Dam30+S3VW1blyvP1/mObWu5RmhWb8LMPP3oUvTpUtZoFt5upQF5p9nXOsIvg6sSXJxkr8GbAR2jul3SV3md0GdN5Y5gqp6IckNwP8ClgGfrKp94/hdUpf5XdDpYGyHmKiqe4B7xvX6czC2xU4LZJ5T61qekVnkd6FL06VLWaBbebqUBeaZJ1UvWm8lSeoRDzEhST1nEUhSz1kEktRzno9gTJKEweEFVjLYgegw8EC1tFLGPN3XtWnSpTxdyjKJeSZmZXGX3pgkbwRuAx4Hnm6GLwR+Bfi9qvoT83QnTxd0bZp0KU+Xskxsnqo67S/AG4EDwP8EPtFcvtiMvbGFPPuB1UPGLwb2m6dbebpw6do06VKeLmWZ1DyTsmjoD4HfqKqDUweTXMxg++1LljjPGQwOLTDd08CZS5wFzHM66No06VKeLmWBCcwzKUXQtTfmkwyOO38nPz3y5CoGhxe43Tydy9MFXZsmw/JcBLythTxOm/nnmdf0mYh1BEluBN7K4Fjv0yfEjqr6gxYyXQr8IwbrLMKgqFo7IUmSSxgcB78reTo1fbqga9OkS5+ZLmWZxDwTUQTQvTdGmjRJzq+qY23n6KIkr6yq77edY6EmZj+CqtpfVVur6t1VdUNzva12/sUkW5N8M8n3m8v+ZuwVLeRZPy3bJ5I8nOTTSS5oIU+npk8XJPmlJB9L8tEkr0zyweY92pFkRQt5zp1+AR5Ick5zfSmzdO3zuzXJec31X0/ybeC+JN9J8vdbyPNQkg8k+RsLfY2JKIKufVCAHcAPgCur6pVV9Urg9cBfAP+thTz/dsr1W4DvAr/F4BDJf9RCnq5Nny64A3iUwaLNLwE/BH4T+Arwn1rI8z3gwWmXlcBDwO4lztK1z++bq+rkSV8+DLytqtYwOC/1LS3kOQd4BfCnSR5I8vtJ/vq8XmGpN3Ua0+ZTD025/gngQwzOxvP7wOdbyPPYQu5boumzZ9p9e5YySxenTxcuwJ9Nuf5kB96jf85gE+xfmzL2REvTpmuf328CZzTX75t2396Wp8/fZbBPwXcZ/EGxeS6vMSlbDU21rqrWNtdvTbKphQzfSfIvgO1VdRSgmTP5HX72/LVL5fwk/4zBupOXJ0k1nxramSvs2vTpgqnvw3+Zdt+ypQwCUFUfbrZCuTXJU8BNDDnF5hLp2uf3o8A9SbYCX0zyH4C7gKuAPS3k+Ymq+grwlSTvZjCH8jbmcEjqSSmCrn1Q3gZsAf538x9cAUcZnJnqrS3k+Tjwsub6dgbnMz2e5Jdo54PbtenTBXcnObuqnquqD5wcTPIrwILP570YVXUIuDbJbwH3Ar/QRg469vmtqv+YZC/wu8CrGfw/+mrg8wyWRiy1b00fqKoTDObovjiXF5iIrYaS3DRt6LaqOvlB+fdV9c4WMv0tBrt531dVz00ZX19Vc3pzxpBnJXB/R/JcDlRVfT3JZcB6BntBtnkyo1Z18D36SR7gBPCqqnqkjTxdnjYTkWepl2e1sPzsn7TwO/8pg7/iPg8cBDZMue+hFvK8u2N5bgLuY7DS8Q+AXcC/Ar4M/Mu2PzNtXDr4HnXmM+y0Gf/0WdLAbVyYtuJtiX7nXuDs5vrq5j+89zS3/8w87GWw3PsXgGeAlzfjLwEebvsz08alo+9RJ/J0Kcuk5pmIdQRJHp7pLqCNzUeXVTN7VlUHk1wJ/Pckv9xk6nueF2qwDPP/Jfm/VfVMk+2HSX7cQp4u6Np71KU8XcoykXkmYj8CBv/Zv5PBtsXTL23s7ffdJCe3XKJ5k36TwUquXzMPP0pycsXjr58cTPKLQF+LoGvvUZfydCnLROaZlJXFtwP/uaq+OuS+T1fVby9xngsZ/NX73SH3XVFV/6fnec6qqueHjJ8HrKiqvUuZpws6+B51Jk+XskxqnokoAknSwk3KoiFJ0gJZBJLUcxaBJPWcRSBJPWcRSFLP/X9vWRh21Khe7gAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "avg_length_songs_by_id['avg(length)'].hist(by =  avg_length_songs_by_id['Churn'], bins = 15 )"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Non Churners seem to be listening more as seen in the histograms above"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Grouping Users by Hour of Day and Churn\n",
    "hh_churn = df.groupBy('Hour_of_day','Churn').count().orderBy('Hour_of_day')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Grouping Users by Day of Month and Churn\n",
    "dom_churn = df.groupBy('day_of_month','Churn').count().orderBy('day_of_month')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAABJ8AAAHhCAYAAADAnR9nAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3df5SldX0n+PdHGoEYMUo3GaBgGhFNgJnphJY1G3WMZiMSFzCrSbMmYDCLshoxs8mMTvYomxxyYhLjGePELA4G8QfoiAayq44M/lozCjZK5HdslUAJIqJJSDKQdPvdP+opUjT3Vld317fuvc3rdc49de/3Ps9T73uprm/z7u/z3GqtBQAAAAB6eMykAwAAAACw71I+AQAAANCN8gkAAACAbpRPAAAAAHSjfAIAAACgG+UTAAAAAN2sm3SAtbZ+/fq2cePGSccAAAAA2Gdcd911326tbRj13KOufNq4cWO2bt066RgAAAAA+4yq+stxzzntDgAAAIBulE8AAAAAdKN8AgAAAKCbR901nwAAAACm0T/+4z9mfn4+DzzwwKSjjHXggQdmbm4u+++//4r3UT4BAAAATIH5+fk8/vGPz8aNG1NVk47zCK213HfffZmfn8/RRx+94v2cdgcAAAAwBR544IEccsghU1k8JUlV5ZBDDtntlVnKJwAAAIApMa3F06I9yad8AgAAAJhy3/zmN7Nly5Ycc8wxOe6443LKKafkwgsvzAtf+MJJR9sl5RMAAADAFGut5UUvelGe85zn5Ktf/Wpuvvnm/NZv/VbuueeevTru9u3bVynh8lxwHAAAAGCKffKTn8z++++fV77ylQ+Nbdq0KX/1V3+Vq6++Oi9+8Ytz44035sQTT8x73vOeVFU2btyYrVu3Zv369dm6dWt+9Vd/NZ/61Kdy/vnn56677srtt9+e9evX56lPfWruuOOOfO1rX8sdd9yR1772tXnNa16zqvmVTwAAAABTbLFYGuVLX/pSbrrpphx++OH58R//8fzZn/1ZnvnMZy57vOuuuy6f/exnc9BBB+X888/Prbfemk9+8pO5//7787SnPS3nnntu9t9//1XL77Q7AAAAgBl10kknZW5uLo95zGOyadOm3H777bvc59RTT81BBx300OOf/umfzgEHHJD169fn0EMP3evT+XamfAIAAACY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\n",
      "text/plain": [
       "<Figure size 1440x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(20,8))\n",
    "sns.barplot(x = 'Hour_of_day', y = 'count', hue = 'Churn', data = hh_churn.toPandas());"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1440x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(20,8))\n",
    "sns.barplot(x = 'day_of_month', y = 'count', hue = 'Churn', data = dom_churn.toPandas());"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Grouping Users by Unique Artists and Churn\n",
    "unique_artist_by_id = ((df.groupBy('userId','Churn').agg(countDistinct('artist')).orderBy('userId')).toPandas())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([<matplotlib.axes._subplots.AxesSubplot object at 0x1197e56a0>,\n",
       "       <matplotlib.axes._subplots.AxesSubplot object at 0x11a68c9a0>],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "unique_artist_by_id['count(artist)'].hist(by =  unique_artist_by_id['Churn'] )"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Churners (1) tend to listen to fewer artists"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Grouping Users by Unique songs and Churn\n",
    "unique_songs_by_id = ((df.groupBy('userId','Churn').agg(countDistinct('song')).orderBy('userId')).toPandas())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([<matplotlib.axes._subplots.AxesSubplot object at 0x11a709970>,\n",
       "       <matplotlib.axes._subplots.AxesSubplot object at 0x11a74acd0>],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "unique_songs_by_id['count(song)'].hist(by =  unique_songs_by_id['Churn'] )"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "No surprises when Churners (1) tend to listen to fewer songs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Grouping Users by Type of Page and Churn\n",
    "page_churn = df.groupBy('page', 'Churn').count().orderBy('count', ascending = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 720x720 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(10,10))\n",
    "sns.barplot(x = 'count', y = 'page', hue = 'Churn', data = page_churn.toPandas(), orient='h');"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Splitting userAent to get Device Type\n",
    "df = df.withColumn(\"_tmp\", pyspark.sql.functions.split(\"userAgent\", \"\\\\;\").getItem(0))\n",
    "df = df.withColumn(\"tmp2\", pyspark.sql.functions.split(\"_tmp\", \"\\\\(\").getItem(1))\n",
    "df = df.withColumn(\"device_type\", pyspark.sql.functions.split(\"tmp2\", \"\\\\)\").getItem(0))\n",
    "df = df.drop('_tmp', 'tmp2', 'userAgent')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [],
   "source": [
    "device_churn =  df.groupBy('device_type', 'Churn').count().orderBy('count', ascending = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 720x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(10,5))\n",
    "sns.barplot(x = 'count', y = 'device_type', hue = 'Churn', data = device_churn.toPandas(), orient='h');"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "# Feature Engineering\n",
    "Once you've familiarized yourself with the data, build out the features you find promising to train your model on. To work with the full dataset, you can follow the following steps.\n",
    "- Write a script to extract the necessary features from the smaller subset of data\n",
    "- Ensure that your script is scalable, using the best practices discussed in Lesson 3\n",
    "- Try your script on the full data set, debugging your script if necessary\n",
    "\n",
    "If you are working in the classroom workspace, you can just extract features based on the small subset of data contained here. Be sure to transfer over this work to the larger dataset when you work on your Spark cluster."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The features that I am creating include:\n",
    "\n",
    "    1. No of unique sessions per user\n",
    "    2. Activity during AM Hours\n",
    "    3. Activity during PM Hours\n",
    "    4. Average song length\n",
    "    5. Longest session by the user\n",
    "    6. User State\n",
    "    7. User City\n",
    "    8. No. of Next Song events\n",
    "    9. No. of Thumbs up counts\n",
    "    10. No of Thumbs Down counts\n",
    "    11. No of Playlist added events\n",
    "    12. No of friend added events\n",
    "    13. Downgrade evnts per user\n",
    "    14. Acivity during first half of the month\n",
    "    15. Activity during second half of the month\n",
    "    16. Home Click count\n",
    "    17. Type of Device"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "root\n",
      " |-- artist: string (nullable = true)\n",
      " |-- gender: string (nullable = true)\n",
      " |-- itemInSession: long (nullable = true)\n",
      " |-- length: double (nullable = true)\n",
      " |-- level: string (nullable = true)\n",
      " |-- page: string (nullable = true)\n",
      " |-- sessionId: long (nullable = true)\n",
      " |-- song: string (nullable = true)\n",
      " |-- ts: long (nullable = true)\n",
      " |-- userId: string (nullable = true)\n",
      " |-- Churn: long (nullable = true)\n",
      " |-- user_city: string (nullable = true)\n",
      " |-- user_state: string (nullable = true)\n",
      " |-- Hour_of_day: string (nullable = true)\n",
      " |-- day_of_month: string (nullable = true)\n",
      " |-- device_type: string (nullable = true)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Print Schema\n",
    "df.printSchema()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Engineering new features as defined above\n",
    "\n",
    "final_df = ((df.groupBy('userId','Churn','gender','user_city','user_state', 'device_type')\n",
    "       .agg(countDistinct('sessionId').alias('unique_sess'),\n",
    "        count(when(col(\"Hour_of_day\") >= 12,1)).alias('PM_count'),\n",
    "        count(when(col(\"Hour_of_day\") < 12,1)).alias('AM_count'),\n",
    "        count(when(col(\"day_of_month\") < 15,1)).alias('first_half_month'),\n",
    "        count(when(col(\"day_of_month\") >= 15,1)).alias('second_half_month'),\n",
    "        avg('length').alias('avg_song_length'), \n",
    "        max('itemInSession').alias('longest_sess'),\n",
    "        count(when(col(\"page\") == 'NextSong',1)).alias('next_song_count'),\n",
    "        count(when(col(\"page\") == 'Thumbs Up',1)).alias('thumbs_up_count'),\n",
    "        count(when(col(\"page\") == 'Thumbs Down',1)).alias('thumbs_down_count'),\n",
    "        count(when(col(\"page\") == 'Add to Playlist',1)).alias('playlist_added_count'),\n",
    "        count(when(col(\"page\") == 'Add Friend',1)).alias('friend_added_count'),\n",
    "        count(when(col(\"page\") == 'Downgrade',1)).alias('Downgrade_count'),\n",
    "        count(when(col(\"page\") == 'Home',1)).alias('home_click_count'),\n",
    "        count(when(col(\"page\") == 'Roll Advert',1)).alias('roll_advert_count'),\n",
    "        )\n",
    "       .orderBy('userId')))\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "root\n",
      " |-- userId: string (nullable = true)\n",
      " |-- Churn: long (nullable = true)\n",
      " |-- gender: string (nullable = true)\n",
      " |-- user_city: string (nullable = true)\n",
      " |-- user_state: string (nullable = true)\n",
      " |-- device_type: string (nullable = true)\n",
      " |-- unique_sess: long (nullable = false)\n",
      " |-- PM_count: long (nullable = false)\n",
      " |-- AM_count: long (nullable = false)\n",
      " |-- first_half_month: long (nullable = false)\n",
      " |-- second_half_month: long (nullable = false)\n",
      " |-- avg_song_length: double (nullable = true)\n",
      " |-- longest_sess: long (nullable = true)\n",
      " |-- next_song_count: long (nullable = false)\n",
      " |-- thumbs_up_count: long (nullable = false)\n",
      " |-- thumbs_down_count: long (nullable = false)\n",
      " |-- playlist_added_count: long (nullable = false)\n",
      " |-- friend_added_count: long (nullable = false)\n",
      " |-- Downgrade_count: long (nullable = false)\n",
      " |-- home_click_count: long (nullable = false)\n",
      " |-- roll_advert_count: long (nullable = false)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Print Schema for new features\n",
    "final_df.printSchema()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Modeling\n",
    "Split the full dataset into train, test, and validation sets. Test out several of the machine learning methods you learned. Evaluate the accuracy of the various models, tuning parameters as necessary. Determine your winning model based on test accuracy and report results on the validation set. Since the churned users are a fairly small subset, I suggest using F1 score as the metric to optimize."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Counting no of rows(users)\n",
    "cols_final = list(final_df.columns)\n",
    "cols_count = final_df.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Missing count and percentages:\n",
      "+----+----------------------+-----------------+------------------+\n",
      "|    | col_name             |   missing_count |   missing_percen |\n",
      "|----+----------------------+-----------------+------------------|\n",
      "|  0 | userId               |               0 |                0 |\n",
      "|  1 | Churn                |               0 |                0 |\n",
      "|  2 | gender               |               0 |                0 |\n",
      "|  3 | user_city            |               0 |                0 |\n",
      "|  4 | user_state           |               0 |                0 |\n",
      "|  5 | device_type          |               0 |                0 |\n",
      "|  6 | unique_sess          |               0 |                0 |\n",
      "|  7 | PM_count             |               0 |                0 |\n",
      "|  8 | AM_count             |               0 |                0 |\n",
      "|  9 | first_half_month     |               0 |                0 |\n",
      "| 10 | second_half_month    |               0 |                0 |\n",
      "| 11 | avg_song_length      |               0 |                0 |\n",
      "| 12 | longest_sess         |               0 |                0 |\n",
      "| 13 | next_song_count      |               0 |                0 |\n",
      "| 14 | thumbs_up_count      |               0 |                0 |\n",
      "| 15 | thumbs_down_count    |               0 |                0 |\n",
      "| 16 | playlist_added_count |               0 |                0 |\n",
      "| 17 | friend_added_count   |               0 |                0 |\n",
      "| 18 | Downgrade_count      |               0 |                0 |\n",
      "| 19 | home_click_count     |               0 |                0 |\n",
      "| 20 | roll_advert_count    |               0 |                0 |\n",
      "+----+----------------------+-----------------+------------------+\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "DataFrame[col_name: string, missing_count: bigint, missing_percen: double]"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Checking missing values for new dataframe\n",
    "missing_perc(final_df, cols_final, cols_count)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Setting up various columns\n",
    "id_cols = ['userId']\n",
    "cat_cols = ['gender','user_city','user_state']\n",
    "num_cols = ['unique_sess','PM_count','AM_count','first_half_month','second_half_month','avg_song_length',\n",
    "           'longest_sess','next_song_count','thumbs_up_count','thumbs_down_count','playlist_added_count',\n",
    "           'friend_added_count','Downgrade_count','home_click_count','roll_advert_count']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Converting column datatypes to Double\n",
    "for col in num_cols + ['Churn']:\n",
    "    final_df = final_df.withColumn(col, final_df[col].cast(types.DoubleType()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "root\n",
      " |-- userId: string (nullable = true)\n",
      " |-- Churn: double (nullable = true)\n",
      " |-- gender: string (nullable = true)\n",
      " |-- user_city: string (nullable = true)\n",
      " |-- user_state: string (nullable = true)\n",
      " |-- device_type: string (nullable = true)\n",
      " |-- unique_sess: double (nullable = false)\n",
      " |-- PM_count: double (nullable = false)\n",
      " |-- AM_count: double (nullable = false)\n",
      " |-- first_half_month: double (nullable = false)\n",
      " |-- second_half_month: double (nullable = false)\n",
      " |-- avg_song_length: double (nullable = true)\n",
      " |-- longest_sess: double (nullable = true)\n",
      " |-- next_song_count: double (nullable = false)\n",
      " |-- thumbs_up_count: double (nullable = false)\n",
      " |-- thumbs_down_count: double (nullable = false)\n",
      " |-- playlist_added_count: double (nullable = false)\n",
      " |-- friend_added_count: double (nullable = false)\n",
      " |-- Downgrade_count: double (nullable = false)\n",
      " |-- home_click_count: double (nullable = false)\n",
      " |-- roll_advert_count: double (nullable = false)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Print Schema\n",
    "final_df.printSchema()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Setup pipeline\n",
    "features_t = {}\n",
    "features_pipe = {}\n",
    "def feature_setup(col, es):\n",
    "    pipe = Pipeline(stages=es)\n",
    "    features_pipe[col] = pipe.fit(final_df.select(final_df[col]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [],
   "source": [
    "# String Indexing and One Hot Encoding of Features,along with Threading\n",
    "for col in cat_cols:\n",
    "    indexer = StringIndexer(inputCol=col, outputCol= col + '_index')\n",
    "    ohe_encoder = OneHotEncoder(dropLast=True, inputCol= col + '_index', outputCol=col+'_ohe')\n",
    "    features_t[col] = threading.Thread(target=feature_setup, args=[col, [indexer, ohe_encoder]])\n",
    "    features_t[col].start()\n",
    "    \n",
    "for col in cat_cols: \n",
    "    features_t[col].join()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Creating a Vector Assembler of features and Scaling the features\n",
    "vector_inputs = [col + '_ohe' for col in cat_cols] + num_cols\n",
    "vector_assembler_features = VectorAssembler(inputCols=vector_inputs, outputCol='features_vector')\n",
    "scaler = StandardScaler(inputCol='features_vector', outputCol='features')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Transformation Pipeline i.e. applying previous steps on data\n",
    "feature_transformation = Pipeline(stages=list(features_pipe.values()) + \n",
    "                                  [vector_assembler_features,scaler]) \\\n",
    "            .fit(final_df.select(num_cols + cat_cols))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Label of features\n",
    "feature_labels = spark.sparkContext.parallelize( \\\n",
    "            [[col, m.stages[0].labels] for col, m in features_pipe.items()] \\\n",
    "            )\n",
    "feature_labels = spark.createDataFrame(feature_labels)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [],
   "source": [
    "feature_labels = feature_labels.withColumnRenamed('_1','Name_of_feature').withColumnRenamed('_2','Value_of_feature')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+---------------+--------------------+\n",
      "|Name_of_feature|    Value_of_feature|\n",
      "+---------------+--------------------+\n",
      "|         gender|              [M, F]|\n",
      "|      user_city|[Los Angeles-Long...|\n",
      "|     user_state|[ CA,  TX,  NY-NJ...|\n",
      "+---------------+--------------------+\n",
      "\n"
     ]
    }
   ],
   "source": [
    "feature_labels.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [],
   "source": [
    "def feature_transformation_fn(df, feature_transformation):\n",
    "    '''\n",
    "    INPUT:\n",
    "    df - (spark dataframe) Dataframe containing new engineered features\n",
    "    feature_transformation (pipeline) - Transformation pipeline\n",
    "    \n",
    "    OUTPUT:\n",
    "    final_transformed - (spark dataframe) Transformed spark dataframe\n",
    "    '''\n",
    "    feature_labels = {}\n",
    "    for stage in feature_transformation.stages:\n",
    "        if isinstance(stage, PipelineModel) and len(stage.stages) > 0:\n",
    "            stageInner = stage.stages[0]\n",
    "            if isinstance(stageInner, StringIndexerModel):\n",
    "                inputCol = stageInner.extractParamMap()[stageInner.getParam('inputCol')]\n",
    "                ip_labels = stageInner.labels\n",
    "                outputCol = stageInner.extractParamMap()[stageInner.getParam('outputCol')]\n",
    "                feature_labels[inputCol]=ip_labels\n",
    "\n",
    "    if len(feature_labels) > 0:\n",
    "        def not_seen(labels):\n",
    "            return f.udf(lambda col_value: col_value if col_value in labels else labels[0])\n",
    "\n",
    "        not_seen_l = {}\n",
    "        for col in df.columns:\n",
    "            if col in num_cols: \n",
    "                not_seen_l[col] = df[col]\n",
    "            elif col in cat_cols: \n",
    "                not_seen_l[col] = not_seen(feature_labels[col])(df[col]).alias(col)\n",
    "        n_unseen = df.select(id_cols + list(not_seen_l.values()) + ['Churn'])\n",
    "    else:\n",
    "        n_unseen = df\n",
    "\n",
    "    # Transform data\n",
    "    final_transformed = feature_transformation.transform(n_unseen)\n",
    "\n",
    "    return final_transformed"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Get the transformed dataframe\n",
    "transformed_df = feature_transformation_fn(final_df, feature_transformation)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Split the data into train, validation and test set in the ratio 0.8:0.1:0.1\n",
    "train_df, validation_df, test_df = transformed_df.randomSplit([0.8,0.1,0.1], 42)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### ALGO 1: RANDOM FORSEST CLASSIFIER"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Defining Random Forest Classifier\n",
    "rfc_classifier = RandomForestClassifier(maxDepth=3, labelCol='Churn', featuresCol='features', seed=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Setting up the parameter grid and Evaluator\n",
    "param_grid = ParamGridBuilder() \\\n",
    "        .addGrid(rfc_classifier.numTrees,[3,4,5]) \\\n",
    "        .addGrid(rfc_classifier.maxDepth, [4,5,6]) \\\n",
    "        .addGrid(rfc_classifier.maxBins, [5,6,7]) \\\n",
    "        .build()\n",
    "\n",
    "evaluator = BinaryClassificationEvaluator( \\\n",
    "          rawPredictionCol = \"prediction\"\n",
    "          ,labelCol = 'Churn' \\\n",
    "          ,metricName = 'areaUnderROC')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Setting up the cross validator\n",
    "cross_validator = CrossValidator( \\\n",
    "          estimatorParamMaps = param_grid \\\n",
    "          ,estimator = rfc_classifier \\\n",
    "          ,evaluator = evaluator \\\n",
    "          ,numFolds = 4 )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run the cross validated pipeline and choose the best model\n",
    "pipeline_model = Pipeline(stages=[cross_validator]).fit(train_df)\n",
    "cv_model = pipeline_model.stages[0]\n",
    "model = cv_model.bestModel"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   Number of Trees  Max Depth  Max Bins\n",
      "0                4          5         6\n"
     ]
    }
   ],
   "source": [
    "# Print Optimal Parameters\n",
    "optimal_params = pd.DataFrame({\n",
    "          'Number of Trees': [model.getNumTrees]\n",
    "          ,'Max Depth': [model.getMaxDepth()]\n",
    "          ,'Max Bins': [model.getMaxBins()]\n",
    "          })\n",
    "print(optimal_params)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [],
   "source": [
    "def metric_fn(df, model, data_type):\n",
    "    '''\n",
    "    INPUT:\n",
    "    df - (spark dataframe) input dataframe for which we need metrics\n",
    "    model - (model) The actual trained model\n",
    "    data_type - (text) Can be Train, Validation, Test wtc.\n",
    "    \n",
    "    OUTPUT:\n",
    "    none\n",
    "    '''\n",
    "    transformed_df = model.transform(df)\n",
    "    results = transformed_df.select(['prediction', 'Churn'])\n",
    "    predictionAndLabels=results.rdd\n",
    "    metrics = MulticlassMetrics(predictionAndLabels)\n",
    "    cm=metrics.confusionMatrix().toArray()\n",
    "    accuracy=(cm[0][0]+cm[1][1])/cm.sum()\n",
    "    precision=(cm[0][0])/(cm[0][0]+cm[1][0])\n",
    "    recall=(cm[0][0])/(cm[0][0]+cm[0][1])\n",
    "    f1_s = (2 * precision * recall)/(precision + recall)\n",
    "    print(data_type + ' METRICS')\n",
    "    print('Confusion Matrix: \\n',cm )\n",
    "    print('Area under ROC:' ,evaluator.evaluate(transformed_df, {evaluator.metricName: \"areaUnderROC\"}))\n",
    "    print('Accuracy: ',accuracy)\n",
    "    print('Precision: ',precision)\n",
    "    print('Recall: ',recall)\n",
    "    print('F1 Score: ',f1_s)\n",
    "    #return cm, accuracy, precision, recall, f1_s"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "TRAIN METRICS\n",
      "Confusion Matrix: \n",
      " [[285.   0.]\n",
      " [ 67.  13.]]\n",
      "Area under ROC: 0.58125\n",
      "Accuracy:  0.8164383561643835\n",
      "Precision:  0.8096590909090909\n",
      "Recall:  1.0\n",
      "F1 Score:  0.8948194662480378\n"
     ]
    }
   ],
   "source": [
    "# Metrics on Training Set\n",
    "metric_fn(train_df, model, 'TRAIN')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "VALIDATION METRICS\n",
      "Confusion Matrix: \n",
      " [[28.  4.]\n",
      " [12.  0.]]\n",
      "Area under ROC: 0.4375\n",
      "Accuracy:  0.6363636363636364\n",
      "Precision:  0.7\n",
      "Recall:  0.875\n",
      "F1 Score:  0.7777777777777777\n"
     ]
    }
   ],
   "source": [
    "# Metrics on Validation Set\n",
    "metric_fn(validation_df, model, 'VALIDATION')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "TEST METRICS\n",
      "Confusion Matrix: \n",
      " [[32.  0.]\n",
      " [ 7.  0.]]\n",
      "Area under ROC: 0.5\n",
      "Accuracy:  0.8205128205128205\n",
      "Precision:  0.8205128205128205\n",
      "Recall:  1.0\n",
      "F1 Score:  0.9014084507042254\n"
     ]
    }
   ],
   "source": [
    "# Metrics on Test Set\n",
    "metric_fn(test_df, model, 'TEST')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### ALGO 2: DECISION TREE CLASSIFIER"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Defining Decision Tree Classifier\n",
    "from pyspark.ml.classification import DecisionTreeClassifier\n",
    "dc_classifier = DecisionTreeClassifier(maxDepth=3, labelCol='Churn', featuresCol='features', seed=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Setting up the parameter grid and Evaluator\n",
    "param_grid_2 = ParamGridBuilder() \\\n",
    "        .addGrid(dc_classifier.maxDepth, [3,4,5]) \\\n",
    "        .addGrid(dc_classifier.maxBins, [30,40,50]) \\\n",
    "        .build()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Setting up the cross validator\n",
    "cross_validator_2 = CrossValidator( \\\n",
    "          estimatorParamMaps = param_grid_2 \\\n",
    "          ,estimator = dc_classifier \\\n",
    "          ,evaluator = evaluator \\\n",
    "          ,numFolds = 4 )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run the cross validated pipeline and choose the best model\n",
    "pipeline_model_2 = Pipeline(stages=[cross_validator_2]).fit(train_df)\n",
    "cv_model_2 = pipeline_model_2.stages[0]\n",
    "model_2 = cv_model_2.bestModel"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   Max Depth  Max Bins\n",
      "0          5        30\n"
     ]
    }
   ],
   "source": [
    "# Print Optimal Parameters\n",
    "optimal_params_2 = pd.DataFrame({\n",
    "          'Max Depth': [model_2.getMaxDepth()]\n",
    "          ,'Max Bins': [model_2.getMaxBins()]\n",
    "          })\n",
    "print(optimal_params_2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "TRAIN METRICS\n",
      "Confusion Matrix: \n",
      " [[284.   1.]\n",
      " [ 51.  29.]]\n",
      "Area under ROC: 0.6794956140350877\n",
      "Accuracy:  0.8575342465753425\n",
      "Precision:  0.8477611940298507\n",
      "Recall:  0.9964912280701754\n",
      "F1 Score:  0.9161290322580646\n"
     ]
    }
   ],
   "source": [
    "# Metrics on Training Set\n",
    "metric_fn(train_df, model_2, 'TRAIN')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "VALIDATION METRICS\n",
      "Confusion Matrix: \n",
      " [[30.  2.]\n",
      " [12.  0.]]\n",
      "Area under ROC: 0.46875\n",
      "Accuracy:  0.6818181818181818\n",
      "Precision:  0.7142857142857143\n",
      "Recall:  0.9375\n",
      "F1 Score:  0.8108108108108109\n"
     ]
    }
   ],
   "source": [
    "# Metrics on Validation Set\n",
    "metric_fn(validation_df, model_2, 'VALIDATION')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "TEST METRICS\n",
      "Confusion Matrix: \n",
      " [[30.  2.]\n",
      " [ 6.  1.]]\n",
      "Area under ROC: 0.5401785714285714\n",
      "Accuracy:  0.7948717948717948\n",
      "Precision:  0.8333333333333334\n",
      "Recall:  0.9375\n",
      "F1 Score:  0.8823529411764706\n"
     ]
    }
   ],
   "source": [
    "# Metrics on Test Set\n",
    "metric_fn(test_df, model_2, 'TEST')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Final Steps\n",
    "Clean up your code, adding comments and renaming variables to make the code easier to read and maintain. Refer to the Spark Project Overview page and Data Scientist Capstone Project Rubric to make sure you are including all components of the capstone project and meet all expectations. Remember, this includes thorough documentation in a README file in a Github repository, as well as a web app or blog post."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
